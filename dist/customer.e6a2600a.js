!function(e,t,o,r,n){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s="function"==typeof a[r]&&a[r],u=s.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function i(t,o){if(!u[t]){if(!e[t]){var n="function"==typeof a[r]&&a[r];if(!o&&n)return n(t,!0);if(s)return s(t,!0);if(l&&"string"==typeof t)return l(t);var c=Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}m.resolve=function(o){var r=e[t][1][o];return null!=r?r:o},m.cache={};var p=u[t]=new i.Module(t);e[t][0].call(p.exports,m,p,p.exports,this)}return u[t].exports;function m(e){var t=m.resolve(e);return!1===t?{}:i(t)}}i.isParcelRequire=!0,i.Module=function(e){this.id=e,this.bundle=i,this.exports={}},i.modules=e,i.cache=u,i.parent=s,i.register=function(t,o){e[t]=[function(e,t){t.exports=o},{}]},Object.defineProperty(i,"root",{get:function(){return a[r]}}),a[r]=i;for(var c=0;c<t.length;c++)i(t[c])}({"5wgJw":[function(e,t,o){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(o),r.export(o,"customerDetails",()=>i);var n=e("@xatom/core"),a=e("../auth"),s=e("../supbase"),u=r.interopDefault(s);let l=()=>{let e=new n.WFComponent("[xa-type=cta-btn]");e.on("click",t=>{t.preventDefault(),e.setTextContent("..."),(0,a.logout)()}),e.setTextContent("Logga ut")},i=async()=>{l();let e=(0,a.userAuth).getUser().id,t=new n.WFComponent('[xa-type="customer-details"]'),o=new n.WFFormComponent('[xa-type="bank-form"]'),r=null;try{let{data:n,error:a}=await (0,u.default).from("Customer").select("*").eq("user_id",e).single();if(a||!n){t.setHTML("<p>No active customer found.</p>");return}r=n;let{firstname:s,lastname:l,adress:i,postalcode:c,postalort:p,uppgiftemail:m,uppgiftphone:d}=t.getManyChildAsComponents({firstname:"[xa-type=firstname]",lastname:"[xa-type=lastname]",adress:"[xa-type=adress]",postalcode:"[xa-type=postalcode]",postalort:"[xa-type=postalort]",uppgiftemail:"[xa-type=uppgiftemail]",uppgiftphone:"[xa-type=uppgiftphone]"});s.setTextContent(r.First_name),l.setTextContent(r.Last_name),i.setTextContent(r.gatuadress),c.setTextContent(r.postnummer),p.setTextContent(r.postort),m.setTextContent(r.email),d.setTextContent(r.phone);let f=document.querySelector('[xa-type="clearingnumber"]'),g=document.querySelector('[xa-type="bankaccountnumber"]');f&&(f.value=r.clearingnumber?.toString()||""),g&&(g.value=r.bankaccountnumber?.toString()||""),o.onFormSubmit(async t=>{o.disableForm();let r=t.clearingnumber,n=t.bankaccountnumber;try{let{data:t,error:a}=await (0,u.default).from("Customer").update({clearingnumber:r,bankaccountnumber:n}).eq("user_id",e).select();if(a)console.error("Error updating customer data:",a.message),o.showErrorState();else{console.log("Customer data updated successfully",t),o.showSuccessState();let e=document.querySelector('[xa-type="success-message"]');if(e){e.style.display="block";let t=3,o=document.getElementById("countdown"),r=setInterval(()=>{t-=1,o&&(o.textContent=t.toString()),t<=0&&(clearInterval(r),location.reload())},1e3)}}}catch(e){console.error("Error during form submission:",e.message),o.showErrorState()}finally{o.enableForm()}})}catch(e){console.error("Error fetching customer details:",e),t.setHTML("<p>Error fetching customer data.</p>")}};i()},{"@xatom/core":"5eqAK","../auth":"apxUl","../supbase":"54PYi","@parcel/transformer-js/src/esmodule-helpers.js":"jiucr"}]},[],0,"parcelRequire89a0");
//# sourceMappingURL=customer.e6a2600a.js.map
